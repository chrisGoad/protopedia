<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="An Open Repository of Prototype Structures for the Visual Domain">
<title>ProtoPedia</title>
<link rel="stylesheet" type="text/css"  href="/style.css"/>
<link rel="stylesheet" type="text/css"  href="spectrum.css"/>
<link rel="icon" href="/images/favicon.ico?v18" />
</head>
<body style="background-color:white;font-size:14pt">
<div id="outerContainer">  
  <div id="topbar"> 
     <div id="topbarOuter" style="padding-bottom:0px"><a href="/"><span style="position:relative;top:-10px" class="mainTitle">ProtoPedia </span></a>
         <img style ="position:relative;border:none;top:0px;left:20px;" alt="images/logo_alt.html" src="/images/logo3.svg"  width="60" height="25"/>
         <div id = "topbarInner" style="position:relative;float:right;top:0px">
                     <a href="/draw.html?source=(sys)/forMainPage/spiralLogo6.item&intro=tutorial_index&fit=0.7" class="ubutton">Tutorial</a>
 <a href="/draw.html" class="ubutton">Draw</a> 
          <a href="/code.html" class="ubutton">Code Editor</a> 
            <a href="/text.html" class="ubutton">Text Editor</a> 
         <a href="/doc/code.html" class="ubutton">Coding Guide</a> 
          <a href="/doc/about.html" class="ubutton">About</a>
           <a id ="signInButton" style="display:none" href="/sign_in.html" class="ubutton">Sign In</a>
           <a id="accountButton" style="display:none" href="/account.html" class="ubutton">Account</a>      
         </div> 
    </div>
  </div>
  <div id="innerContainer" style="margin-top:10px">
   

<div class="pageTitle">Build an Adjustable Network Diagram with Code</div>




 <p> Here is a simple diagram
  <span style="position:relative;top:5px"><img height="20" src = "https://firebasestorage.googleapis.com/v0/b/project-5150272850535855811.appspot.com/o/twitter%3A14822695%2FforMainPage%2Flogo.svg?alt=media"> </span> in the <a href="/draw.html?source=/example/simpleDiagramAsGraph.js&intro=code_intro">main drawing UI</a> (also known as the "structure editor"), in which it can be adjusted and extended, and in the  <a href="/code.html?source=/example/simpleDiagramAsGraph.js">code editor</a>, where you can experiment with the code.  (There is no need
 to sign in to experiment - but signing in <i>is</i> required to save your work.)</p>
 
<p>It is implemented by the following code:</p>


 
<p style="padding:5px"></p><pre class="code">
pj.require('/diagram/graph.js','/shape/circle.js','/shape/arcArrow.js',
function (graphP,circlePP,arrowPP) {
  var geom = pj.geom,svg = pj.svg,ui = pj.ui;
  var item = svg.Element.mk('&lt;g&gt;');// the root of the diagram we are assembling
  var graph = item.set('graph',graphP.instantiate());
  var circleP = graph.installAsVertexPrototype(circlePP);
  var arrowP = graph.installAsEdgePrototype(arrowPP);
  circleP.r = 12;
  circleP.fill = 'blue';
  var circle1 = graph.addVertex();
  var circle2 = graph.addVertex();
  circle1.__moveto(geom.Point.mk(-50,0));
  circle2.__moveto(geom.Point.mk(50,0));
  // set the parameters of the edge prototype
  arrowP.stroke = 'orange';
  arrowP.radius = 1; // radius of the arc as a multiple of arrow length
  arrowP.tailGap = 7; // gap between tail of arrow and its designated start point
  arrowP.headGap = 7; // gap between head of arrow and its designated end
  arrowP.solidHead = false;
  graph.connectVertices(circle1,circle2);
  graph.connectVertices(circle2,circle1);
  return item;
});

</pre>

 
 <p>This example illustrates building a  diagram using operations defined by its diagram type. Diagram types are external components,
 rather than anything built into  the ProtoPedia platform itself. The platform allows adding as many diagram types as you like, each with its own API.
 In this case, the diagram type is a network - a collection of nodes
 connected by arrows or lines, defined in <span class="codeWord">/diagram/graph.js</span>. Such a structure is  referred to as a <i>graph</i> in mathematical terminology. In this terminology the nodes are called "vertices"
 and the connectors "edges" - a terminology adopted in the API.</p>
 
 <p>Now, lets walk through the code.</p>
 
  <p style="padding:5px"></p><pre class="code">
    pj.require('/diagram/graph.js','/shape/circle.js','/shape/arcArrow.js',
    function (graphP,circlePP,arrowPP) {
</pre>
  <p>
<b><i>pj</i></b> The ProtoPedia implementation is installed under the one global variable,  <span class="codeWord">prototypeJungle</span>,
with <span class="codeWord">pj</span> as a synonym (like <span class="codeWord">$</span> for <a href="https://jquery.com">jQuery</a>). Furthermore, the ProtoPedia implementation
 <a href="/doc/tech.html#implementation">is itself a prototype tree</a>,
 with functionality allocated under children such as <span class="codeWord">pj.geom, pj.svg,</span> and <span class="codeWord">pj.ui</span>. </p>
  
<p style="padding-left:40px;padding-right:40px;font-size:11pt"><i>Aside</i>:Doing things this way may seem old-school
in that it forgoes use of 
flexible module systems such as
<a href="https://en.wikipedia.org/wiki/CommonJS">commonJS</a>,
<a href="https://en.wikipedia.org/wiki/Asynchronous_module_definition">AMD</a>, or
<a href="http://2ality.com/2014/09/es6-modules-final.html">ES6 modules</a>.
However, the hierarchical nature
  of the implementation is needed for the serialization scheme to work properly, so this flexibility is sacrificed
  for a reason.
Of course, whatever module system is preferred may be used in 
projects which include the <a href="/doc/code.html#codeStructure">prototypeJungle libraries</a>. Ironically, ProtoPedia
has its own module-like capability in pj.require, but this is used in external contexts,  not the construction of the prototypeJungle tree
itself.  </p>
  <p><span class="codeWord">pj.require(...</span>

 binds the variables <span class="codeWord">graphP</span>, <span class="codeWord">circlePP</span> and  <span class="codeWord">arrowPP</span> to the components defined in <span class="codeWord">'/diagram/graph.js'</span>, <span class="codeWord">'/shape/circle.js'</span>, and
 <span class="codeWord">'/shape/arcArrow.js'</span>, respectively. Moving on:</p>

<p style="padding:5px"></p><pre class="code">
    var item = svg.Element.mk('&lt;g/&gt;');// the root of the diagram we are assembling
</pre>

 

<p><span class="codeWord">pj.svg.Element.mk</span> creates a prototype tree from
<a href="https://developer.mozilla.org/en-US/docs/Web/SVG">SVG</a> markup.</p>

<p style="padding:5px"></p><pre class="code">
    var graph = item.set('graph',graphP.instantiate());
</pre>

<p> installs an instantiation of the graph component under the root. Instantiation, a fundamental operation in
ProtoPedia, is explained <a href = "/doc/tech.html#instantiation_summary">here</a>.</p><p>
<span class="codeWord">item.set('name',ch)</span>  has the effect of <span class="codeWord">item.name = ch</span>, but also assigns <span class="codeWord">item</span> as the parent of
<span class="codeWord">ch</span> (ProtoPedia items are trees, as explained
<a href="/doc/code.html#trees">here</a>).
</p>

<p style="padding:5px"></p><pre class="code">
    var circleP = graph.installAsVertexPrototype(circlePP);
</pre>

<p>This defines the prototype that will be used for vertices in this graph as a circle. Note that installAsVertexPrototype is a method
of  the graph component, defined externally to the ProtoPedia platform.</p>


<p style="padding:5px"></p><pre class="code">
    var arrowP = graph.installAsEdgePrototype(arrowPP);
</pre>

<p> has similar effect.</p>

<p style="padding:5px"></p><pre class="code">
    var circle1 = graph.addVertex();
</pre>

<p>  instantiates the vertex prototype assigned by installAsVertexPrototype.</p>

<p style="padding:5px"></p><pre class="code">
  circle1.__moveto(geom.Point.mk(-50,0));
</pre>

<p> moves the resulting circle to the given position. __moveto and geom.Point.mk are operations defined by the platform.</p>

<p>circle2 is created and moved analogously.</p>

<p style="padding:5px"></p><pre class="code">
 graph.connectVertices(circle1,circle2);
</pre>  
  <p>instantiates the edge prototype (in this case an arrow), and connects its ends to circle1 and circle2 respectively.
  <span class="codeWord">graph.connectVertices(circle2,circle1);</span> runs an arrow in the other direction.</p>
  
  <p> The diagram can also be constructed without use of the graph component, but then the arrows won't be automatically
  updated with dragging of the circles - the graph component handles that. This more direct approach is presented here to give a better feeling
  for how to build things outside of the context of particular diagrams. The approach involves these alternative snippets of code for introducing the circles and arrows:</p>
  <p style="padding:5px"></p><pre class="code">
  var circleP = item.set('circleP',circlePP.instantiate());
  item.set('circle1',circleP.instantiate()).__show();
  item.set('circle2',circleP.instantiate()).__show();
  </pre>
  and
  <p style="padding:5px"></p><pre class="code">
  var arrowP = item.set('arrowP',arrowPP.instantiate());
  item.set('arrow1',arrowP.instantiate()).__show();
  item.set('arrow2',arrowP.instantiate()).__show();
  </pre>
  
  <p>The <span class="codeWord">__show()</span>s are needed because 
   items in the catalog  are initially hidden by convention, as they normally
   serve as prototypes, which should be invisible.</p>
  
  <p> Since there is no autopositioning of the arrows, we also need: </p>
   <p style="padding:5px"></p><pre class="code">
   var p1 = geom.Point.mk(-50,0);
   var p2 = geom.Point.mk(50,0)
   item.arrow1.setEnds(p1,p2); //set start and end points of the arrow
   item.arrow2.setEnds(p2,p1);
   </pre>
   
   <p>This variant of the code can be found <a href="/code.html?source=/example/simpleDiagram.js">here</a>.</p>
 
  


  </div>
</div>
</body>
</html>

