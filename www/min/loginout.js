var __pj__=function(){var t={};if(!Object.create){var e={};return e.om={},e.page={},e}var e=Object.create(t),n=Object.create(t);return n.DNode=t,e.om=n,e.page=Object.create(t),n.storage=localStorage,e}();if(function(t){var e=t.om,n=t.page,r=[],o=e.DNode;e.LNode=r,e.isDev=location.href.indexOf(":8000")>0,e.mapUrlToDev=function(t){return e.isDev&&0==t.indexOf("http://prototypejungle.org/")?"http://prototypejungle.org:8000"+t.substr(26):t},e.__parent__=t,e.__name__="om",o.__parent__=e,o.__name__="DNode",r.__parent__=e,r.__name__="LNode",n.__parent__=t,n.__name__="page",e.activeConsoleTags=["error"],e.itemHost="http://s3.prototypejungle.org",e.argsToString=function(t){if("undefined"==typeof console)return"";for(var e=[],n=t.length,r=0;n>r;r++)e.push(t[r]);return e.join(", ")},e.slog1=function(t){"undefined"!=typeof console&&console.log("SLOG1",t)},e.slog=function(){var t=e.argsToString(arguments);e.slog1(t)},e.startTime=Date.now()/1e3,e.resetClock=function(){e.startTime=Date.now()/1e3},e.elapsedTime=function(){var t=Date.now()/1e3,n=t-e.startTime;return Math.round(1e3*n)/1e3},e.tlog=function(){if("undefined"!=typeof console){for(var t=[],n=Date.now()/1e3,r=n-e.startTime,o=arguments.length,i=0;o>i;i++)t.push(arguments[i]);r=Math.round(1e3*r)/1e3;var a="AT "+r+": "+t.join(", ");console.log(a)}},e.log=function(t){if("undefined"!=typeof console&&($.inArray("all",e.activeConsoleTags)>=0||$.inArray(t,e.activeConsoleTags)>=0))if("undefined"==typeof window)system.stdout(t+JSON.stringify(arguments));else{for(var n=[],r=arguments.length,o=0;r>o;o++)n.push(arguments[o]);console.log(t,n.join(", "))}},e.error=function(){for(var t=[],e=arguments.length,n=0;e>n;n++)t.push(arguments[n]);throw console.log(t.join(", ")),"error"},e.ajaxPost=function(t,n,r,o){if("string"==typeof n)a=n;else{var i=e.storage.sessionId;i&&(n.sessionId=i,n.userName=e.storage.userName);var a=JSON.stringify(n)}o||(o=function(t,e){alert("ERROR (INTERNAL) IN POST "+e)}),$.ajax({url:t,data:a,cache:!1,contentType:"application/json",type:"POST",dataType:"json",success:r,error:o})},e.ajaxGet=function(t,e,n){var r={url:t,cache:!1,contentType:"application/json",type:"GET",dataType:"json",success:e};n&&(r.error=n),r.error=function(t,e){alert("ERROR (INTERNAL) IN get "+e)},$.ajax(r)},e.runCallbacks=function(t){if(void 0!=t){var n=arguments,r=[],o=n.length;for(i=1;o>i;i++)r.push(n[i]);e.arrayForEach(t,function(t){t.apply(void 0,r)})}},e.pathLast=function(t){if("string"==typeof t){var e=t.lastIndexOf("/");return t.substr(e+1)}return t[t.length-1]},e.pathExceptLast=function(t){if("string"==typeof t){var e=t.lastIndexOf("/");return t.substr(0,e+1)}var n=t.concat();return n.pop(),n},e.toInt=function(t){var e=parseFloat(t);return 0==e%1?e:void 0},e.removeFromArray=function(t,e){var n=[];return t.forEach(function(t){t!=e&&n.push(t)}),n},e.getScript=function(t,n){e.log("util","About to load ",t),$.ajax({crossDomain:!0,dataType:"script",url:t,success:function(){e.log("util","loaded ",t),n&&n()}})},e.parseQuerystring=function(){var t={},e=window.location.search.replace("?",""),n=e.split("&");return $.each(n,function(e,n){var r=n.split("=");r.length>1&&(t[r[0]]=r[1])}),t},e.nDigits=function(t,e){if("number"!=typeof t)return t;var n=String(t),r=n.indexOf(".");if(0>r)return n;var o=n.length;if(e>=o-r-1)return n;var i=n.substring(0,r),a=n.substring(r+1,r+e+1);return i+"."+a},e.toType=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},e.mkLink=function(t){return'<a href="'+t+'">'+t+"</a>"},e.mkCapLink=function(t,n){return"<div class='linkLine'><div class='caption'>"+t+"</div>"+e.mkLink(n)+"</div>"},e.mkEmbed=function(t){return'&lt;iframe width="500" height="500" src="'+t+'"&gt;\n '},e.mkLinks=function(t,n){var r=t.repo;e.itemHost;var o=e.itemHost+r,i=o+t.code,a=o+t.data,s=t.url,u=location.host,c="http://"+u+"/inspect?item="+s,f=s,h="<div class='links'>";return h+=e.mkCapLink("To inspect the item you just "+n+":",c),h+=e.mkCapLink("To view the item you just "+n+" (Developers: use this in code depdendencies too):",f),h+="<div class='embed'>",h+="<p>To embed the item you just "+n+":</p>",h+=e.mkEmbed(s),h+="<p>(adjust width and height to taste)</p>",h+="</div>",h+=e.mkCapLink("The JSON that describes the structure of this item:",a),h+=e.mkCapLink("The JavaScript functions associated with this item:",i)},e.check=function(t,e,n){var r=n(t);return void 0===r?{error:1,message:"<center><span class='errorTitle'>Error</span>: "+e+"</center>"}:r},e.checkNumber=function(t){return e.check(t,"expected number.",function(e){return isNaN(e)?void 0:parseFloat(t)})},e.checkInteger=function(t){return e.check(t,"expected integer.",function(e){if(isNaN(e))return void 0;var n=parseFloat(t);return 0==n%1?n:void 0})},e.checkPositiveInteger=function(t){return e.check(t,"expected positive integer.",function(e){if(isNaN(e))return void 0;var n=parseFloat(t);return n>0&&0==n%1?n:void 0})},e.checkPositiveNumber=function(t){return e.check(t,"expected positive number.",function(e){if(isNaN(e))return void 0;var n=parseFloat(t);return n>0?n:void 0})},e.checkNonNegative=function(t){return e.check(t,"expected non-negative number.",function(e){if(isNaN(e))return void 0;var n=parseFloat(t);return n>=0?n:void 0})},e.checkBoolean=function(t){return e.check(t,"No failure possible",function(t){if("false"==t)var e=0;else e=t?1:0;return e})},e.toBooleanOut=function(t){return t?"true":"false"},e.DNode.booleanField=function(t){this.setInputF(t,e,"checkBoolean"),this.setOutputF(t,e,"toBooleanOut")};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};e.escapeHtml=function(t){return String(t).replace(/[&<>"'\/]/g,function(t){return a[t]})},e.afterChar=function(t,e){var n=t.indexOf(e);return 0>n?t:t.substr(n+1)},e.beforeChar=function(t,e){var n=t.indexOf(e);return 0>n?t:t.substr(0,n)},e.endsIn=function(t,e){var n=t.length,r=e.length;if(r>n)return!1;var o=t.substr(n-r);return o==e},e.mainName=function(t){var n=e.beforeChar(t,"_"),r=e.afterChar(t,"_");return"persona"==n?e.beforeChar(r,"@"):r},e.checkName=function(t){return""==t?!1:!!t.match(/^(?:|_|[a-z]|[A-Z])(?:\w|-)*$/)},e.checkPathName=function(t){var e=t.split("/"),n=e.length;if(0==n)return!1;for(var r=0;n>r;r++)if(!checkName(e[r]))return!1;return!0},e.setOnEnter=function(t,e){t.keyup(function(t){13==t.keyCode&&e(t)})},e.disableBackspace=function(){var t=/INPUT|SELECT|TEXTAREA/i;$(document).bind("keydown keypress",function(e){8==e.which&&(!t.test(e.target.tagName)||e.target.disabled||e.target.readOnly)&&e.preventDefault()})},e.clearStorageOnLogout=function(){e.storage.removeItem("sessionId"),e.storage.removeItem("userName"),e.storage.removeItem("handle"),e.storage.removeItem("signingInWithTwitter"),e.storage.removeItem("twitterToken"),e.storage.removeItem("lastPrefix"),e.storage.removeItem("lastBuildUrl"),e.storage.removeItem("email")},e.checkSession=function(t){e.storage.sessionId?e.ajaxPost("/api/checkSession",{},function(n){e.log("util","checked session; result:",JSON.stringify(n)),"fail"==n.status&&e.clearStorageOnLogout(),t(n)}):t({status:"fail",msg:"noSession"})}}(__pj__),function(t){function e(t,e,n){i.isNode(n)?(n.__name__=e,n.__parent__=t):n&&"object"==typeof n&&i.error('Only Nodes and atomic values can be set as children in <Node>.set("'+e+'",<val>)')}function n(t,n,r){e(t,n,r),t[n]=r}function r(t,e,n){if(e!=n){var o=Object.getOwnPropertyNames(e);o.forEach(function(e){i.internal(e)||(t[e]=1)}),r(t,Object.getPrototypeOf(e),n)}}function o(t,e){var n=i.getMethod(t,"update");n?n.call(t,e):t.iterTreeItems(function(t){if(e){var n=t.__name__,r=e[n];"object"!=typeof r&&(r=void 0)}o(t,r)},!0)}function r(t,e,n){if(e!=n){var o=Object.getOwnPropertyNames(e);o.forEach(function(e){i.internal(e)||(t[e]=1)}),r(t,Object.getPrototypeOf(e),n)}}var i=t.om;i.__externalReferences__=[],i.isObject=function(t){return t&&"object"==typeof t},i.isAtomic=function(t){return!i.isObject(t)},i.isNode=function(t){return i.DNode.isPrototypeOf(t)||i.LNode.isPrototypeOf(t)},i.nodeMethod=function(t,e){i.LNode[t]=i.DNode[t]=e},i.nodeMethod("createDescendant",function(t){var e=this;return t.forEach(function(n){if(""!=n){i.checkName(n)||i.error('Ill-formed name "'+n+'". Names may contain only letters, numerals, and underbars, and may not start with a numeral');var r=e[n];if(void 0===r){var o=i.DNode.mk();e.set(n,o),e=o}else e.hasOwnProperty(n)||i.error("Conflict in createDescencant",t.join("/")),i.isNode(r)||i.error("Conflict in createDescendant ",t.join("/")),e=r}}),e}),i.nodeMethod("computed",function(){return this.__computed__=1,this}),i.nodeMethod("mfreeze",function(t){return"string"==typeof t?this.setFieldStatus(t,"mfrozen"):this.__mfrozen__=1,this}),i.DNode.set=function(t,e,r){if("string"==typeof t)var o=t.indexOf("/");else o=-1;if(o>=0)var a=t.split("/"),s=a.pop(),u=this.createDescendant(a);else u=this,s=t;return i.checkName(s)||i.error('Ill-formed name "'+s+'". Names may contain only letters, numerals, and underbars, and may not start with a numeral'),n(u,s,e),"mfrozen"==r&&u.mfreeze(s),e},i.LNode.set=function(t,e){return n(this,t,e),e},i.LNode.pushChild=function(t){var n=this.length;e(this,n,t),this.push(t)},i.DNode.setf=function(t,e){return this.set(t,e,"mfrozen")},i.DNode.setN=function(t,e){return e?this.set(t,i.toNode(e)):void 0},i.DNode.setIfMissing=function(t){return void 0===this[t]&&this.set(t,i.DNode.mk()),this[t]},i.DNode.mk=function(){return Object.create(i.DNode)},i.LNode.mk=function(t){var e=Object.create(i.LNode);if(void 0==t)return e;for(var n=t.length,r=0;n>r;r++){var o=t[r];o.__parent__=e,o.__name__=""+r,e.push(o)}return e},i.mkLNode=i.LNode.mk,t.set("anon",i.DNode.mk()),i.toNode1=function(t,e,n){var r=typeof n;if(null===n||"object"!=r)return t[e]=n,void 0;if(i.isNode(n))var o=n;else if(Array.isArray(n))var o=i.toLNode(n,null);else var o=i.toDNode(n,null);o.__parent__=t,o.__name__=e,t[e]=o},i.toDNode=function(t,e){if(i.DNode.isPrototypeOf(t))return t;if(e)var n=e;else var n=i.DNode.mk();for(k in t)if(t.hasOwnProperty(k)){var r=t[k];i.toNode1(n,k,r)}return n},i.toLNode=function(t,e){if(e)var n=e;else n=i.LNode.mk();return t.forEach(function(t){n.pushChild(i.toNode(t))}),n},i.toNode=function(t){return Array.isArray(t)?i.toLNode(t):t&&"object"==typeof t?i.toDNode(t):t},i.lift=i.toNode,i.DNode.iterItems=function(t){for(var e in this)this.hasOwnProperty(e)&&!i.internal(e)&&t(this[e],e);return this},i.DNode.ownProperties=function(){var t=Object.getOwnPropertyNames(this),e=[];return t.forEach(function(t){i.internal(t)||e.push(t)}),e},i.DNode.properties=function(t){var e={};r(e,this,t?t:i.DNode);var n=[];for(var o in e)n.push(o);return n},i.DNode.iterTreeItems=function(t,e){var n=Object.getOwnPropertyNames(this),r=this;return n.forEach(function(n){r.treeProperty(n,e)&&t(r[n],n)}),this},i.DNode.iterInheritedItems=function(t,e,n){function r(n){var r=o[n];!e&&"function"==typeof r||i.internal(n)||t(r,n)}var o=this,a=this.properties();return n&&a.sort(),a.forEach(r),this},i.DNode.iterInheritedTreeItems=function(t,e){for(var n in this)this.inheritedTreeProperty(n)&&t(this[n],n);if(!e)return this;var r=this;return e.forEach(function(e){if(r.treeProperty(e)){var n=r[e];t(n,e)}}),this},i.LNode.iterItems=function(t){return this.forEach(t),this},i.LNode.iterTreeItems=function(t,e){var n=this;return this.forEach(function(r,o){n.treeProperty(o,e)&&t(r,o)}),this},i.LNode.iterInheritedItems=function(t){return this.forEach(t),this},i.DNode.iterValues=function(t){var e=!1;for(var n in this)this.treeProperty(n)&&t(this[n])&&(e=!0);return e},i.DNode.setProps=function(t){return i.setProperties(this,t)},i.DNode.keys=function(){var t=[];for(var e in this)this.hasOwnProperty(e)&&!i.internal(e)&&t.push(e);return t},i.nodeMethod("pathOf",function(e){var n=[],r=this.__parent__;if(!r)return void 0;for(var o=this;o;){if(o==e)return n;if(o==t)return n.unshift("/"),n;n.unshift(o.__name__),o=i.getval(o,"__parent__")}return void 0}),i.nodeMethod("topAncestorName",function(t){if(this==t)return void 0;var e=this.__parent__;return e?e==t?this.__name__:e.topAncestorName(t):void 0});var a={om:1};i.inStdLib=function(e){var n=e.topAncestorName(t);return a[n]},i.pathToString=function(t,e){e||(e="/");var n=t.length,r=t.join(e);return n>0&&t[0]==e?r.substr(1):r},i.nodeMethod("remove",function(){var t=this.__parent__,e=this.__name__;t[e]=void 0}),i.DNode.values=function(){var t=[];for(var e in this)this.hasOwnProperty(e)&&!i.internal(e)&&t.push(this[e]);return t},i.removeDups=function(t){var e={},n=[];return t.forEach(function(t){void 0===e[t]&&(e[t]=1,n.push(t))}),n},i.evalPath=function(e,n,r){if(n){if("string"==typeof n)var o=n.split("/");else o=n;var i=o[0];if(""==i||"/"==i){if(r)var a=r;else var a=t;var s=o.concat();s.shift()}else a=e,s=o;for(var u=s.length,c=0;u>c;c++){var f=s[c],h=typeof a;if(!a||"object"!=h&&"function"!=h)return void 0;a=a[f]}return a}},i.nodeMethod("pathSetValue",function(t,e,n){var r=e.length-1,o=e.slice(0,r),i=e[r],a=this.evalPath(o);a&&(a[i]=n)}),i.applyMethod=function(t,e,n){if(e&&("object"==typeof e||"function"==typeof e)){var r=e[t];if(r&&"function"==typeof r)return r.apply(e,n)}return e},i.internalProps={__parent__:1,__protoChild__:1,__value__:1,__hitColor__:1,__chain__:1,__copy__:1,__name__:1,widgetDiv:1,__protoLine__:1,__inCopyTree__:1,__headOfChain__:1},i.internal=function(t){return i.internalProps[t]},i.DNode.findPropertyOnInheritanceChain=function(t){var e=this.get(t);if("undefined"!=typeof e)return this;var n=Object.getPrototypeOf(this);return n.__parent__?n.findPropertyOnInheritanceChain(t):void 0},i.DNode.inheritedTreeProperty=function(t,e){if(i.internal(t))return!1;var n=this[t],r=typeof n;if(!n||"object"!=r&&"function"!=r){if(e)return!1;var o=this.findPropertyOnInheritanceChain(t);return o?!0:!1}var a=n.__parent__;return a==this},i.nodeMethod("treeProperty",function(t,e){if(!this.hasOwnProperty(t)||i.internal(t))return!1;var n=this[t];return i.isNode(n)?n.__parent__==this:!e}),i.nodeMethod("nonAtomicTreeProperty",function(t){return this.treeProperty(t,1)}),i.nodeMethod("children",function(){var t=[];return this.iterValues(function(e,n){i.isObject(n)&&t.push(n)}),t}),i.hasMethod=function(t,e){var n=typeof t;if(t&&"object"==n){var r=t[e];if("function"==typeof r)return r}return void 0},i.nodeMethod("getMethod",function(t,e){var n=typeof t;if(t&&"object"==n){var r=t[e];if("function"==typeof r)return r}return void 0}),i.nodeMethod("treeOfSelections",function(){var t;return this.iterTreeItems(function(e){var n=e.__name__;if(e.__selected__)t=t?t:{},t[n]=1;else{var r=e.treeOfSelections();r&&(t=t?t:{},t[n]=r)}},!0),t}),i.nodeMethod("installTreeOfSelections",function(e){1==e?(this.__selected__=!0,this.deepSetProp("__selectedPart__",1),this.setPropForAncestors("__descendantSelected__",1,t.draw.wsRoot)):e&&this.iterTreeItems(function(t){var n=t.__name__;t.installTreeOfSelections(e[n])},!0)}),i.nodeMethod("deepUpdate",function(t,e){e||(e=this.treeOfSelections()),o(this,t),t&&this.installOverrides(t),this.installTreeOfSelections(e)}),i.DNode.addOverride=function(t,e,n){var r=this[e],o=this.pathOf(n),a=t;o.forEach(function(t){var e=a[t];i.isObject(e)||(e={},a[t]=e),a=e}),a[e]=r},i.pathLookup=function(t,e){for(var n=e.length,r=t,o=0;n>o;o++){var i=e[o],r=r[i];if(void 0===r)return void 0}return r},i.DNode.findInOverride=function(t,e){var n=this.pathOf(e);return i.pathLookup(t,n)},i.DNode.transferToOverride=function(t,e,n){if(t){var r=this.findInOverride(t,e),o=this;r&&n.forEach(function(t){var e=o[t],n=typeof e;"object"==n&&e||(r[t]=e)})}},i.nodeMethod("removeComputed",function(){this.__computed__?this.remove():this.iterTreeItems(function(t){t.removeComputed()},!0)}),i.removeValues=function(t){t.deepApplyMeth("removeValue",null,!0)},i.arrayToDict=function(t){var e={};return t.forEach(function(t){e[t]=1}),e},i.DNode.xferProperty=function(t,e){var n=e[t];return void 0===n?void 0:(this[t]=n,n)},i.DNode.setProperties=function(t,e,n,r){if(t){if(e)var o=i.arrayToDict(e);for(var a in t)if(t.hasOwnProperty(a)){if(e&&void 0===o[a])continue;var s=t[a];if(void 0===s)continue;r&&(s=i.toNode(s)),this.set(a,s,n)}return this}},i.DNode.setPropertiesN=function(t,e,n){return this.setProperties(t,e,n,1)},i.nodeMethod("checkTree",function(){var t=this;this.iterTreeItems(function(e,n){e.__parent__!=t&&i.error(t,e,"bad parent"),e.__name__!=n&&i.error(t,e,"bad name"),e.checkTree()},!0)}),i.DNode.stripOm=function(){var t={};for(var e in this)if(this.nonAtomicTreeProperty(e)){var n=this[e];t[e]=n.stripOm()}else{n=this[e];var r=typeof n;n&&"object"!=r&&"function"!=r&&(t[e]=n)}return t},i.LNode.stripOm=function(){for(var t=[],e=this.length,n=0;e>n;n++)if(this.nonAtomicTreeProperty(n)){var r=this[n];t.push(r.stripOm())}else{r=this[n];var o=typeof r;r&&"object"!=o&&"function"!=o&&t.push(r)}return t},i.createJsFunction=function(){function t(t){return Function.apply(this,t)}return t.prototype=Function.prototype,function(e){return new t(e)}}(),i.pw="vMfm7i1r",i.parseFunctionText=function(t){xnc=t;var e=/\s*function\s*\w*\s*\(([^\)]*)\)/,n=xnc.match(e),r=n[1].split(","),o=xnc.indexOf(")"),a=xnc.substring(o+1),s=a.indexOf("{"),u=a.lastIndexOf("}"),c=a.slice(s+1,u),f=r.concat(c),h=i.createJsFunction(f);return h},i.toFunction=function(t){"function"!=typeof t&&i.error("Expected function");var e=i.parseFunctionText(t.toString());return new i.Function(e)},i.DNode.installType=function(t,e){if(e)n=e;else var n=i.DNode.mk();return n.__isType__=1,this.set(t,n),n},i.DNode.namedType=function(){return this.__isType__=1,this},i.DNode.protoPath=function(t){var e=Object.getPrototypeOf(this),n=i.getval(e,"__parent__");if(!n)return void 0;var r=i.pathOf(e,t);return r},i.nodeMethod("get",function(t){return this.hasOwnProperty(t)?this[t]:void 0}),i.getval=function(t,e){return t||i.error("null v"),t.hasOwnProperty(e)?t[e]:void 0},i.DNode.lastProtoInTree=function(){var t=Object.getPrototypeOf(this),e=t.__parent__;return e?t.lastProtoInTree():this},i.DNode.protoName=function(){var t=Object.getPrototypeOf(this),e=t.__parent__;if(!e)return"";if(t.get("__isType__")){var n=t.__name__;return n?n:""}return t.protoName()},i.LNode.protoName=function(){return"LNode"},i.DNode.hasTreeProto=function(){var t=Object.getPrototypeOf(this);return t&&t.__parent__},Function.prototype.hasTreeProto=function(){return!1},i.LNode.hasTreeProto=function(){return!1},i.nodeMethod("deepApplyFun",function(t){t(this),this.iterTreeItems(function(e){e.deepApplyFun(t)},!0)}),i.nodeMethod("applyFunToAncestors",function(t,e){if(t(this),this!=e){var n=this.__parent__;n&&n.applyFunToAncestors(t,e)}}),i.nodeMethod("deepApplyMeth",function(t,e,n){var r=i.getMethod(this,t),o=!0;r&&(r.apply(this,e),n||(o=!1)),o&&this.iterTreeItems(function(r){r.deepApplyMeth(t,e,n)},!0)}),i.nodeMethod("deepSetProp",function(t,e){this.deepApplyFun(function(n){n[t]=e})}),i.nodeMethod("deepDeleteProps",function(t){this.deepApplyFun(function(e){t.forEach(function(t){delete e[t]})})}),i.nodeMethod("setPropForAncestors",function(t,e,n){this.applyFunToAncestors(function(n){n[t]=e},n)}),i.LNode.maxOrMin=function(t,e){var n=e?-1/0:1/0;return this.forEach(function(r){var o=r[t];"number"==typeof n&&(n=e?Math.max(n,o):Math.min(n,o))}),n},i.LNode.min=function(t){return this.maxOrMin(t,!1)},i.LNode.max=function(t){return this.maxOrMin(t,!0)},i.nodeMethod("funstring1",function(t,e){this.iterTreeItems(function(n,r){if(i.isNode(n))n.funstring1(t,e+r+".");else if("function"==typeof n){var o=t[0],a=n.toString();o+=e+r+" = "+a,o+="\n\n",t[0]=o}})}),i.nodeMethod("funstring",function(e){if(e)var n="__pj__.anon.";else var r=this.pathOf(t),n="__pj__."+r.join(".")+".";var o=[""];return this.funstring1(o,n),o[0]}),i.DNode.findOwner=function(t){for(var e=this;e;){if(e.hasOwnProperty(t))return e;e=Object.getPrototypeOf(e)}},i.DNode.inheritsPropertyFrom=function(t,e){var n=!0;if(this==t)return this.hasOwnProperty(e);if(!t.isPrototypeOf(this))return!1;var r=t[e];if(void 0===r)return!1;for(var o=this;;){var i=Object.getPrototypeOf(o);if(i==t)return n?!0:i.hasOwnProperty(e);o=i}},i.LNode.inheritsPropertyFrom=function(){return!1},i.nodeMethod("treeInheritsPropertyFrom",function(t,e){if(this.inheritsPropertyFrom(t,e))return!0;for(var n in this)if(this.treeProperty(n,!0)){var r=this[n];if(r.treeInheritsPropertyFrom(t,e))return!0}return!1}),i.DNode.inheritsSomePropertyFrom=function(t){if(this==t)return!0;if(!t.isPrototypeOf(this))return!1;for(var e=Object.getOwnPropertyNames(t),n=e.length,r=0;n>r;r++){var o=e[r];if(!i.internal(o)&&this.inheritsPropertyFrom(t,o))return!0}return!1},i.LNode.inheritsSomePropertyFrom=function(){return!1},i.nodeMethod("treeInheritsSomePropertyFrom",function(t,e){if(this.inheritsSomePropertyFrom(t,e))return!0;for(var n in this)if(this.treeProperty(n,!0)){var r=this[n];if(r.treeInheritsSomePropertyFrom(t,e))return!0}return!1}),i.LNode.eval=function(){return this},i.DNode.createChild=function(t,e){var n=this[t];return n?n:(n=e(),this.set(t,n),n)},i.DNode.setNote=function(t,e){var n=this.setIfMissing("__notes__");n[t]=e},i.DNode.setInputF=function(e,n,r){var o=this.setIfMissing("__inputFunctions__"),a=i.pathToString(n.pathOf(t)),s=a+"/"+r;o[e]=s},i.DNode.setOutputF=function(e,n,r){var o=this.setIfMissing("__outputFunctions__"),a=i.pathToString(n.pathOf(t)),s=a+"/"+r;o[e]=s},i.DNode.getBeforeDNode=function(t){if(this==i.DNode)return void 0;var e=this.get(t);if(void 0!==e)return e;var n=Object.getPrototypeOf(this);return n.getBeforeDNode(t)},i.DNode.getInputF=function(e){var n=this.__inputFunctions__;if(n){var r=n.getBeforeDNode(e);return i.evalPath(t,r)}},i.LNode.getInputF=function(){return void 0},i.DNode.getOutputF=function(e){var n=this.__outputFunctions__;if(n){var r=n.getBeforeDNode(e);return i.evalPath(t,r)}},i.LNode.getOutputF=function(){return void 0},i.DNode.getNote=function(t){var e=this.__notes__;return e?e[t]:void 0},i.LNode.getNote=function(){return void 0},i.nodeMethod("isComputed",function(){return this.__computed__?!0:this==t?!1:this.__parent__.isComputed()}),i.nodeMethod("isMfrozen",function(){return this.__mfrozen__?!0:this==t?!1:this.__parent__.isMfrozen()}),i.DNode.setFieldStatus=function(t,e){var n=this.setIfMissing("__fieldStatus__");n[t]=e},i.DNode.getFieldStatus=function(t){var e=this.get("__fieldStatus__");return e?e[t]:void 0},i.DNode.fieldIsFrozen=function(t){if(this.isMfrozen())return!0;var e=this.getFieldStatus(t);return e&&0==e.indexOf("mfrozen")},i.nodeMethod("installOverrides",function(t){for(var e in t){var n=t[e];if(i.isObject(n)){var r=this[e];i.isNode(r)&&r.installOverrides(n)}else this[e]=n}}),i.installType("DataSource"),i.DataSource.mk=function(t){var e=Object.create(i.DataSource);return e.url=t,e.setf("link",""),i.setDataSourceLink(t,e),e},i.dataSourceBeingLoaded=null,i.loadedData=[],i.loadDataTimeout=2e3,t.loadData=function(t){var e=i.loadDataCallback;i.loadedData[i.dataSourceBeingLoaded]=1,e&&e(t)},i.loadDataError=function(e){t.page.genError("Could not load "+e)},i.DataSource.loadTheData=function(t){setTimeout(function(){var t=i.dataSourceBeingLoaded;i.loadedData[t]||i.loadDataError(t)},i.loadDataTimeout);var e=i.mapUrlToDev(this.url);i.dataSourceBeingLoaded=e,i.loadDataCallback=t,$.ajax({crossDomain:!0,dataType:"script",url:e})},i.collectedDataSources=void 0,i.DataSource.collectThisDataSource=function(){i.collectedDataSources.push(this)},i.collectDataSources=function(t){return i.collectedDataSources=[],t.deepApplyMeth("collectThisDataSource"),i.collectedDataSources},i.loadNextDataSource=function(t,e){var n=i.collectedDataSources,r=n.length;if(t==r)return e(),void 0;var o=n[t],a=function(n){o.set("data",i.toNode(n)),o.__current__=1,i.loadNextDataSource(t+1,e)};return o.__current__?(i.loadNextDataSource(t+1,e),void 0):(o.loadTheData(a),void 0)},i.loadTheDataSources=function(t,e){i.loadedData=[],t.forEach(function(t){i.collectDataSources(t)}),i.loadNextDataSource(0,e)},i.newDataSource=function(e,n){n.url=e,n.__current__=0;var r=function(e){n.set("data",i.toNode(e)),n.__current__=1,t.tree.updateAndShow()};return n.loadTheData(r),e},i.setDataSourceLink=function(t,e){var n=e.url;return e.link="<a href='"+n+"'>"+n+"</a>",t},i.DataSource.setInputF("url",i,"newDataSource"),i.DataSource.setOutputF("url",i,"setDataSourceLink"),i.DNode.ownProperties=function(){var t=Object.getOwnPropertyNames(this),e=[];return t.forEach(function(t){i.internal(t)||e.push(t)}),e},i.DNode.properties=function(t){var e={};r(e,this,t?t:i.DNode);var n=[];for(var o in e)n.push(o);return n}}(__pj__),function(t){var e=t.om,n=t.set("user",t.om.DNode.mk());n.signInWithTwitter=function(){var t=location.host,n="http://"+t+"/api/twitterRequestToken";e.storage.signingInWithTwitter="yes",location.href=n},n.signedInWithPersona=function(){var t=e.storage.userName;return t?0==t.indexOf("persona_"):!1},n.personaSetup=function(){e.log("persona","setup","email["+localStorage.email+"]"),navigator.id.watch({loggedInUser:localStorage.email,onlogin:function(t){e.ajaxPost("/api/personaLogin",{assertion:t,login:1},function(t){if("ok"==t.status){var n=t.value;e.storage.sessionId=n.sessionId;var r=n.userName,o=e.afterChar(r,"_");e.storage.userName=n.userName,e.storage.email=o;var i=n.handle;i?(e.storage.handle=n.handle,location.href="/"):location.href="/handle.html"}else $("#results").html("Login did not succeed"),navigator.id.logout()})},onlogout:function(){n.signedInWithPersona(),e.ajaxPost("/api/logOut",{},function(){e.clearStorageOnLogout()})}})}}(__pj__),"undefined"==typeof __pj__)var __pj__={};!function(t){var e=t.om,n=t.page;n.genButtons=function(t,r){function o(e,n){var r=$('<div class="button">'+e+"</div>");return t.append(r),r.click(function(){location.href=n}),r}if(toExclude=r.toExclude,o("GitHub","https://github.com/chrisGoad/prototypejungle"),"build"!=toExclude&&o("Build","/build"),"tech"!=toExclude&&o("Tech Docs","/tech"),"about"!=toExclude&&o("About","/about"),"sign_in"!=toExclude){n.logoutButton=o("logout","/logout"),n.signInButton=o("Sign in","/sign_in");var i=e.storage?e.storage.sessionId:null;i?n.signInButton.hide():n.logoutButton.hide()}},n.genTopbar=function(t,e){t.empty(),t.append($('<div id="topbarOuter" style="padding-bottom:30px"><div id = "topbarInner" style="float:right;"></div>'));var r=$("#topbarInner");e.includeTitle&&n.genMainTitle($("#topbarOuter"),"Prototype Jungle"),n.genButtons(r,e)},n.genMainTitle=function(t,e){var n=$('<span class="mainTitle">'+e+"</span>");n.css({cursor:"pointer"}),t.append(n),n.click(function(){location.href="/"})},n.logout=function(){e.log("util","page.logout"),n.logoutButton.hide(),n.signInButton.show(),e.clearStorageOnLogout()}}(__pj__),function(t){t.om;var e=t.page;e.genError=function(t){e.errorOccurred||(e.genTopbar($("#topbar"),{includeTitle:1}),e.elementsToHideOnError.forEach(function(t){t.hide()}),e.errorOccurred=1,$("#error").show(),$("#error").html(t))}}(__pj__);